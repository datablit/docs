import { Table } from "@/components/Table";

# Create New Experiment

To create a new Experiment, open the Experiment Tab in the Events section.

## Overview

Experiment allows you to test different versions of feature, content, or user experience to determine what performs better. Datablit experiment platform provides:

- **Variant Management**: Create and manage multiple experiment variants
- **Traffic Allocation**: Control what percentage of users see each variant
- **Real-time Results**: Monitor experiment performance in real-time
- **Statistical Significance**: Built-in statistical analysis for reliable results

## Creating an Experiment

Follow these steps to create and configure your first experiment:

### Step 1: Navigate to Experiments

1. Go to the **Experiments** tab in the [Datablit Console](https://console.datablit.com)
2. Click on **+ Experiment** to create a new experiment

### Step 2: Basic Configuration

Provide the following information for your experiment:

{" "}

<Table
  columns={[
    { header: "PROPERTY", width: "20%" },
    { header: "TYPE", width: "15%" },
    { header: "REQUIRED", width: "10%" },
    { header: "DESCRIPTION", width: "50%" },
  ]}
  data={[
    [
      "Experiment name",
      "String",
      "Yes",
      "A string to understand the experiment purpose",
    ],
    ["Description", "String", "Yes", "Description of the experiment"],
    [
      "Tags",
      "Dropdown",
      "No",
      <>
        Tags to categorize experiments. You can manage tags in the{" "}
        <a
          href={process.env.NEXT_PUBLIC_DATABLIT_CONSOLE_URL}
          className="text-blue-600 hover:text-blue-800 underline"
        >
          company profile section
        </a>
      </>,
    ],
  ]}
/>

Click **Create** to save your experiment

### Step 3: Advanced Configuration

Experiment will get added on experiment list after its created. Click on the experiment to access the details page to configure advance settings:

<Table
  columns={[
    { header: "PROPERTY", width: "20%" },
    { header: "TYPE", width: "15%" },
    { header: "REQUIRED", width: "10%" },
    { header: "DESCRIPTION", width: "50%" },
  ]}
  data={[
    [
      "Status",
      "Dropdown",
      "Yes",
      <>
        By default, the status is set to Active. To disable the experiment,
        change the status to Disabled. Once disabled, all entities will receive
        the <b>control</b> variant.
      </>,
    ],
    [
      "Percentage",
      "Number",
      "Yes",
      <>
        Specify the percentage of entities (e.g., users, devices, etc.) for
        which the experiment should be enabled. For example, if the percentage
        is set to 10, the experiment will return a test variant for 10% of the
        entities. The remaining 90% will receive the <b>control</b> variant.
      </>,
    ],
    [
      "Variants",
      "Popup",
      "Yes",
      <>
        Click "Create Variant" to add a new variant. To create a variant,
        provide a unique name (note: 'control' is reserved and cannot be used)
        and assign a percentage value to it.
      </>,
    ],
    [
      "Static Allotment",
      "Dropdown",
      "No",
      <>
        To assign a specific test entity ID to a particular variant, enter the
        ID, choose the desired variant, and click "Assign." This ensures that
        the specified ID consistently receives the selected variant, regardless
        of the experimentâ€™s configuration or rollout percentage.
      </>,
    ],
  ]}
/>

## Understanding Experiment Assignment

Traffic allocation in Datablit experiments works on a two-level system:

### Example Configuration

Let's consider an experiment with the following setup:

- **Overall Percentage**: 20% of total users
- **Variants**:
  - `v1` (60% of experiment traffic)
  - `v2` (40% of experiment traffic)

### Traffic Distribution

- **20% of users** participate in the experiment
  - 60% of these users (12% of total) receive variant `v1`
  - 40% of these users (8% of total) receive variant `v2`
- **80% of users** receive the **control** variant (no experiment)

## Retrieving Experiment Variants

To determine which variant a user should see, you can retrieve the experiment assignment using either the Datablit SDK or direct API calls.

### Method 1: Using Datablit SDK

The recommended approach is to use the Datablit SDK for your platform. Check out the [Datablit SDK documentation](/docs/datablit-sdk) and navigate to your platform's specific implementation.

### Method 2: Direct API Call

```sh
curl --location 'https://api.datablit.com/api/1.0/experiment/variant?expId=01JVJT9CPXGEJVC7TDSX538Y8F&entityId=1321' \
--header 'apiKey: 01JSWDEZYM0E19ZF3RMHS75PB1'
```

#### Finding Your Experiment ID

You can find your experiment ID from the Datablit Console:

1. Navigate to your experiment details page
2. Extract the `expId` from the URL

**Example URL:**

```
https://console.datablit.com/events/23as2/experiment/01K0KQZ9FW71J8JJVXG8NZ2XN3
```

**Experiment ID:** `01K0KQZ9FW71J8JJVXG8NZ2XN3`

#### API Response

The API returns the assigned variant for the specified entity:

```json
{
  "expId": "01JVJT9CPXGEJVC7TDSX538Y8F",
  "entityId": "1321",
  "variant": "control"
}
```
