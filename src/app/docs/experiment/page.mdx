import { Table } from "@/components/Table";

# A/B Experiments with Datablit

Datablit's experiment platform enables you to run comprehensive A/B tests and feature experiments to optimize user experience and drive data-driven decisions. This guide will walk you through setting up and managing experiments using the Datablit platform.

## Overview

A/B experiments allow you to test different versions of features, content, or user experiences to determine which performs better. Datablit's experiment platform provides:

- **Variant Management**: Create and manage multiple experiment variants
- **Traffic Allocation**: Control what percentage of users see each variant
- **Real-time Results**: Monitor experiment performance in real-time
- **Statistical Significance**: Built-in statistical analysis for reliable results

## Prerequisites

Before setting up experiments, ensure you have:

- A Datablit account with access to the [Datablit Console](https://console.datablit.com)
- Integrated Datablit SDK in your application ([Learn more about SDK integration](/docs/datablit-sdk))
- Basic understanding of A/B testing concepts

## Creating an Experiment

Follow these steps to create and configure your first experiment:

### Step 1: Navigate to Experiments

1. Go to the **Experiments** tab in the [Datablit Console](https://console.datablit.com)
2. Click on **+ Experiment** to create a new experiment

### Step 2: Basic Configuration

Provide the following information for your experiment:

{" "}

<Table
  columns={[
    { header: "PROPERTY", width: "20%" },
    { header: "TYPE", width: "15%" },
    { header: "REQUIRED", width: "10%" },
    { header: "DESCRIPTION", width: "50%" },
  ]}
  data={[
    [
      "Experiment name",
      "String",
      "Yes",
      "A string to understand the experiment purpose",
    ],
    ["Description", "String", "Yes", "Description of the experiment"],
    [
      "Tags",
      "Dropdown",
      "No",
      <>
        Tags to categorize experiments. You can manage tags in the{" "}
        <a
          href={process.env.NEXT_PUBLIC_DATABLIT_CONSOLE_URL}
          className="text-blue-600 hover:text-blue-800 underline"
        >
          company profile section
        </a>
      </>,
    ],
  ]}
/>
3. Click **Create** to save your experiment

### Step 3: Advanced Configuration

Once your experiment is created, it will appear in the experiments list. Click on your experiment to access the details page where you can configure advanced settings:

<Table
  columns={[
    { header: "PROPERTY", width: "20%" },
    { header: "TYPE", width: "15%" },
    { header: "REQUIRED", width: "10%" },
    { header: "DESCRIPTION", width: "50%" },
  ]}
  data={[
    [
      "Status",
      "Dropdown",
      "Yes",
      <>
        By default, the value is active. To disable the experiment, change this
        to disabled. Once disabled, the experiment returns the <b>control</b>{" "}
        variant for all entities.
      </>,
    ],
    [
      "Percentage",
      "Number",
      "Yes",
      <>
        Percentage of entities (users, devices, etc.) for which the experiment
        should be enabled. For example, if percentage is 10, this experiment
        will return experiment variants for 10% of entities. The remaining 90%
        will receive the <b>control</b> variant.
      </>,
    ],
    [
      "Variants",
      "Popup",
      "Yes",
      <>
        Click on <b>Create Variant</b> to add new variants. To create a new
        variant, provide a unique variant name (except 'control' as it's
        reserved) and its percentage allocation.
      </>,
    ],
    [
      "Static Allotment",
      "Dropdown",
      "No",
      <>
        Allows you to assign specific test entity IDs to certain variants. Enter
        the entity ID, select the desired variant, and click assign. This will
        assign the given ID to the specified variant regardless of the
        experiment's normal allocation rules.
      </>,
    ],
  ]}
/>

## Understanding Experiment Assignment

Traffic allocation in Datablit experiments works on a two-level system:

### Example Configuration

Let's consider an experiment with the following setup:

- **Overall Percentage**: 20% of total users
- **Variants**:
  - `v1` (60% of experiment traffic)
  - `v2` (40% of experiment traffic)

### Traffic Distribution

- **20% of users** participate in the experiment
  - 60% of these users (12% of total) receive variant `v1`
  - 40% of these users (8% of total) receive variant `v2`
- **80% of users** receive the **control** variant (no experiment)

## Retrieving Experiment Variants

To determine which variant a user should see, you can retrieve the experiment assignment using either the Datablit SDK or direct API calls.

### Method 1: Using Datablit SDK

The recommended approach is to use the Datablit SDK for your platform. Check out the [Datablit SDK documentation](/docs/datablit-sdk) and navigate to your platform's specific implementation.

### Method 2: Direct API Call

```sh
curl --location 'https://api.datablit.com/api/1.0/experiment/variant?expId=01JVJT9CPXGEJVC7TDSX538Y8F&entityId=1321' \
--header 'apiKey: 01JSWDEZYM0E19ZF3RMHS75PB1'
```

#### Finding Your Experiment ID

You can find your experiment ID from the Datablit Console:

1. Navigate to your experiment details page
2. Extract the `expId` from the URL

**Example URL:**

```
https://console.datablit.com/events/23as2/experiment/01K0KQZ9FW71J8JJVXG8NZ2XN3
```

**Experiment ID:** `01K0KQZ9FW71J8JJVXG8NZ2XN3`

#### API Response

The API returns the assigned variant for the specified entity:

```json
{
  "expId": "01JVJT9CPXGEJVC7TDSX538Y8F",
  "entityId": "1321",
  "variant": "control"
}
```
